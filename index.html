<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lojas Link App Baby</title>

    <meta name="theme-color" content="#2D5A88">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>

    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background-color: #f0f4f8; scroll-behavior: smooth; }
        header { background: #2D5A88; padding: 25px 10px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .titulo-app { color: #ffffff; font-size: 1.5rem; font-weight: bold; margin: 0; display: flex; align-items: center; justify-content: center; gap: 8px; flex-wrap: wrap; }
        .subtitulo { color: rgba(255, 255, 255, 0.9); font-size: 0.8rem; font-weight: bold; letter-spacing: 2px; margin-top: 8px; }
        .container { padding: 15px; max-width: 800px; margin: auto; }

        /* NOVO ESTILO DO CARROSSEL DESLIZANTE */
        .banner-container {
            width: 100%;
            height: 200px !important;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 20px;
            background: #ffffff;
            position: relative;
        }

        .banner-wrapper {
            display: flex; /* Coloca os banners em linha */
            width: 100%;
            height: 100%;
            transition: transform 0.8s ease-in-out; /* Suavidade no movimento */
        }

        .banner-link {
            min-width: 100%; /* Cada banner ocupa o espa√ßo todo */
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        .banner-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* Garante que a foto apare√ßa INTEIRA */
        }

        .categorias { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; padding: 10px 0 20px; }
        @media (max-width: 600px) {
            .categorias { display: grid !important; grid-template-columns: repeat(4, 1fr); gap: 5px; }
            .cat-btn { max-width: 100% !important; padding: 10px 2px !important; font-size: 0.65rem !important; }
        }

        .cat-btn { background: white; padding: 10px 15px; border-radius: 15px; font-size: 0.8rem; font-weight: bold; color: #2D5A88; border: none; box-shadow: 0 2px 5px rgba(0,0,0,0.1); cursor: pointer; flex: 1 1 auto; max-width: 45%; text-align: center; }
        .cat-btn.active { background: #2D5A88; color: white; }

        .busca-container { margin-bottom: 20px; }
        .busca-input { width: 100%; padding: 15px; border-radius: 30px; border: none; box-shadow: 0 5px 15px rgba(0,0,0,0.05); text-align: center; outline: none; box-sizing: border-box; }

        .vitrine { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; }
        .produto-card { background: white; border-radius: 20px; padding: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05); display: flex; flex-direction: column; justify-content: space-between; position: relative; }
        .selo-destaque { position: absolute; top: 10px; left: 10px; background: #ff0000; color: white; font-size: 0.6rem; font-weight: bold; padding: 4px 8px; border-radius: 5px; z-index: 5; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
       
        .btn-ws-card { position: absolute; top: 10px; right: 10px; background: #25D366; border: none; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 10; }
        .btn-ws-card img { width: 18px; height: 18px; }

        .img-produto { width: 100%; height: 140px; object-fit: contain; border-radius: 15px; }
        .produto-nome { font-size: 0.9rem; font-weight: 600; margin-top: 10px; margin-bottom: 8px; height: 35px; overflow: hidden; }
        .produto-info { font-size: 0.7rem; color: #777; margin-bottom: 8px; height: 30px; overflow: hidden; }
        .produto-categoria-tag { font-size: 0.6rem; color: #2D5A88; font-weight: bold; text-transform: uppercase; margin-bottom: 8px; background: #eef4f9; display: inline-block; padding: 2px 8px; border-radius: 10px; }
        .produto-preco { color: #2D5A88; font-size: 1.1rem; font-weight: bold; margin-bottom: 10px; }

        .btn { display: flex; align-items: center; justify-content: center; gap: 4px; text-decoration: none; padding: 10px; border-radius: 12px; font-weight: bold; font-size: 0.7rem; text-transform: uppercase; }
        .btn-hotmart { background: #FF0000; color: #ffffff; }
        .btn-ml { background: #FFE600; color: #2D3277; }
        .btn-magalu { background: #0086FF; color: white; }
        .btn-amazon { background: #000000; color: #00A8E1; }
        .btn-shopee { background: #FF5722; color: white; }

        .btn-share-loja { background: #25D366; color: white; border: none; padding: 8px 15px; border-radius: 20px; font-weight: bold; cursor: pointer; font-size: 0.7rem; margin-top: 10px; display: inline-flex; align-items: center; gap: 5px; }

        #btnVoltarTopo { position: fixed; bottom: 20px; right: 20px; background: #2D5A88; color: white; border: none; width: 45px; height: 45px; border-radius: 50%; font-size: 20px; cursor: pointer; display: none; box-shadow: 0 4px 10px rgba(0,0,0,0.3); z-index: 1000; font-weight: bold; }
    </style>
</head>
<body>

<header id="topo">
    <div class="titulo-app">üçº üë∂üèΩ Lojas Link App Baby üë∂üèª üçº</div>
    <div class="subtitulo">BUENO SOFTWARE üõ†Ô∏è</div>
    <button class="btn-share-loja" onclick="compartilharLoja()">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="15"> COMPARTILHAR LOJA
    </button>
</header>

<div class="container">
    <div class="banner-container">
        <div class="banner-wrapper" id="bannerApp">
            </div>
    </div>

    <div class="categorias">
        <button class="cat-btn active" onclick="filtrar('todos')">Todos ‚ú®</button>
        <button class="cat-btn" onclick="filtrar('em-alta')">Em alta üî•</button>
        <button class="cat-btn" onclick="filtrar('cursos')">Cursos üéì</button>
        <button class="cat-btn" onclick="filtrar('enxoval')">Enxoval üß∫</button>
        <button class="cat-btn" onclick="filtrar('higiene')">Higiene üß¥</button>
        <button class="cat-btn" onclick="filtrar('quarto')">Quarto üõèÔ∏è</button>
        <button class="cat-btn" onclick="filtrar('passeio')">Passeio üõí</button>
        <button class="cat-btn" onclick="filtrar('alimenta√ß√£o')">Alimenta√ß√£o ü•£</button>
    </div>

    <div class="busca-container">
        <input type="text" id="inputBusca" class="busca-input" placeholder="üîç O que voc√™ procura hoje?" onkeyup="executarBusca()">
    </div>

    <div id="vitrine" class="vitrine"></div>
</div>

<button id="btnVoltarTopo" onclick="voltarAoTopo()">‚Üë</button>

<script>
    let todosOsProdutos = [];
    let categoriaAtual = 'todos';
    const sheetId = '1tPuavQtvVf147OX05Y4q8DIo5_HdtkmZelq4PCXq5eg';
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=loja`;

    window.onscroll = function() {
        const btn = document.getElementById("btnVoltarTopo");
        if (document.body.scrollTop > 400 || document.documentElement.scrollTop > 400) {
            btn.style.display = "block";
        } else {
            btn.style.display = "none";
        }
    };

    function voltarAoTopo() {
        window.scrollTo({top: 0, behavior: 'smooth'});
    }

    async function carregarDados() {
        try {
            const response = await fetch(url);
            const text = await response.text();
            const jsonData = JSON.parse(text.substring(47).slice(0, -2));
            todosOsProdutos = jsonData.table.rows;
            todosOsProdutos.sort(() => Math.random() - 0.5);
            configurarBanners();
            mostrarProdutos();
        } catch (error) { console.error(error); }
    }

    // NOVA FUN√á√ÉO DE BANNER AUTOM√ÅTICO E DESLIZANTE
    function configurarBanners() {
        const bannerWrapper = document.getElementById('bannerApp');
        let htmlBanners = '';
        let count = 0;

        todosOsProdutos.forEach((row) => {
            const imgBanner = row.c[2] ? row.c[2].v : '';
            const linkBanner = row.c[1] ? row.c[1].v : '#';
           
            if (imgBanner && imgBanner.includes('http')) {
                htmlBanners += `
                    <a href="${linkBanner}" target="_blank" class="banner-link" onclick="gtag('event', 'click_banner', { banner_id: ${count} })">
                        <img src="${imgBanner}" class="banner-img">
                    </a>`;
                count++;
            }
        });

        bannerWrapper.innerHTML = htmlBanners;

        if (count > 1) {
            let index = 0;
            setInterval(() => {
                index++;
                if (index >= count) {
                    index = 0;
                }
                const deslocamento = index * -100;
                bannerWrapper.style.transform = `translateX(${deslocamento}%)`;
            }, 4000); // Muda a cada 4 segundos
        }
    }

    function mostrarProdutos(termo = '') {
        let html = '';
        const termoBusca = termo.toLowerCase();

        todosOsProdutos.forEach((row) => {
            if (!row.c[3] || row.c[3].v === "Nome") return;
           
            const nome = row.c[3].v;
            const preco = row.c[4] ? row.c[4].f || row.c[4].v : '0,00';
            const categoriaOriginal = row.c[5] ? row.c[5].v : '';
            const categoriaChave = categoriaOriginal.toLowerCase().trim();
            const destaque = row.c[6] ? row.c[6].v.toLowerCase().trim() : '';
            const tipo = row.c[7] ? row.c[7].v.toLowerCase().trim() : '';
            const foto = row.c[8] ? row.c[8].v : '';
            const link = row.c[9] ? row.c[9].v : '#';
            const info = row.c[10] ? row.c[10].v : '';

            const bateDestaque = (categoriaAtual === 'em-alta' && destaque === 'sim');
            const bateCategoria = (categoriaAtual === 'todos' || categoriaChave === categoriaAtual || bateDestaque);
            const bateBusca = nome.toLowerCase().includes(termoBusca) || tipo.includes(termoBusca);

            if (bateCategoria && bateBusca) {
                let seloHtml = destaque === 'sim' ? `<div class="selo-destaque">MAIS VENDIDO üî•</div>` : '';
                let btnClass = 'btn-ml', btnTexto = `üõí MERCADO LIVRE ü§ùüèª `;
               
                if(tipo === 'hotmart') { btnClass = 'btn-hotmart'; btnTexto = `üõí HOTMART üî•`; }
                else if(tipo === 'magalu') { btnClass = 'btn-magalu'; btnTexto = `üõí MAGALU üôãüèª‚Äç‚ôÄÔ∏è`; }
                else if(tipo === 'amazon') { btnClass = 'btn-amazon'; btnTexto = `üõí Amazon üì¶`; }
                else if(tipo === 'shopee') { btnClass = 'btn-shopee'; btnTexto = `üõí Shopee üõçÔ∏è`; }

                html += `
                    <div class="produto-card">
                        ${seloHtml}
                        <button class="btn-ws-card" onclick="compartilharProduto('${nome}', '${link}')">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg">
                        </button>
                        <div>
                            <img src="${foto}" class="img-produto" onerror="this.src='https://via.placeholder.com/150'">
                            <div class="produto-nome">${nome}</div>
                            <div class="produto-info">${info}</div>
                            <div class="produto-categoria-tag">${categoriaOriginal}</div>
                        </div>
                        <div>
                            <div class="produto-preco">R$ ${preco}</div>
                            <a href="${link}" target="_blank" class="btn ${btnClass}" onclick="gtag('event', 'click_venda', {item: '${nome}'})">${btnTexto}</a>
                        </div>
                    </div>`;
            }
        });
        document.getElementById('vitrine').innerHTML = html;
    }

    function filtrar(cat) {
        categoriaAtual = cat;
        gtag('event', 'select_category', { category: cat });
        document.querySelectorAll('.cat-btn').forEach(b => {
            b.classList.toggle('active', b.innerText.toLowerCase().includes(cat.replace('-',' ')) || (cat==='todos' && b.innerText.includes('Todos')));
        });
        mostrarProdutos(document.getElementById('inputBusca').value);
    }

    function executarBusca() { mostrarProdutos(document.getElementById('inputBusca').value); }

    function compartilharLoja() {
        const txt = 'Confira as melhores ofertas para o seu beb√™ na Lojas Link App Baby!';
        const urlLoja = window.location.href;
        gtag('event', 'share', { method: 'WhatsApp', content_type: 'app' });
        if(navigator.share) {
            navigator.share({ title: 'Link Baby', text: txt, url: urlLoja });
        } else {
            window.open(`https://api.whatsapp.com/send?text=${txt} ${urlLoja}`);
        }
    }

    function compartilharProduto(nome, link) {
        const txt = `Olha essa oferta na Lojas Link Baby: ${nome}`;
        gtag('event', 'share', { method: 'WhatsApp', content_type: 'produto', item_id: nome });
        if(navigator.share) {
            navigator.share({ title: nome, text: txt, url: link });
        } else {
            window.open(`https://api.whatsapp.com/send?text=${txt} ${link}`);
        }
    }

    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js').catch(err => console.log('SW erro', err));
        });
    }

    window.onload = carregarDados;
</script>
</body>
</html>

 
